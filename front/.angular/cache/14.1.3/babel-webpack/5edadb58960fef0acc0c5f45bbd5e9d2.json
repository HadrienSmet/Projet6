{"ast":null,"code":"import { catchError, EMPTY, map, of, switchMap, take, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/sauces.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/material/progress-spinner\";\nimport * as i6 from \"@angular/material/button\";\n\nfunction SingleSauceComponent_mat_spinner_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\");\n  }\n}\n\nconst _c0 = function (a0, a1, a2) {\n  return {\n    \"fas liked\": a0,\n    \"far\": a1,\n    \"disabled\": a2\n  };\n};\n\nconst _c1 = function (a0, a1, a2) {\n  return {\n    \"fas disliked\": a0,\n    \"far\": a1,\n    \"disabled\": a2\n  };\n};\n\nfunction SingleSauceComponent_div_1_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 14)(2, \"i\", 15);\n    i0.ɵɵlistener(\"click\", function SingleSauceComponent_div_1_div_11_Template_i_click_2_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.onLike());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 16)(6, \"i\", 17);\n    i0.ɵɵlistener(\"click\", function SingleSauceComponent_div_1_div_11_Template_i_click_6_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.onDislike());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"span\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const sauce_r2 = i0.ɵɵnextContext().ngIf;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(4, _c0, ctx_r3.liked, !ctx_r3.liked, ctx_r3.disliked));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(sauce_r2.likes);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(8, _c1, ctx_r3.disliked, !ctx_r3.disliked, ctx_r3.liked));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(sauce_r2.dislikes);\n  }\n}\n\nfunction SingleSauceComponent_div_1_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelement(1, \"mat-spinner\", 19);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SingleSauceComponent_div_1_button_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function SingleSauceComponent_div_1_button_16_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r11.onModify());\n    });\n    i0.ɵɵtext(1, \"MODIFY\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SingleSauceComponent_div_1_button_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function SingleSauceComponent_div_1_button_17_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.onDelete());\n    });\n    i0.ɵɵtext(1, \"DELETE\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SingleSauceComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelement(1, \"img\", 3);\n    i0.ɵɵelementStart(2, \"div\", 4)(3, \"h1\", 5);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 6);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"h3\");\n    i0.ɵɵtext(8, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, SingleSauceComponent_div_1_div_11_Template, 9, 12, \"div\", 7);\n    i0.ɵɵtemplate(12, SingleSauceComponent_div_1_div_12_Template, 2, 0, \"div\", 8);\n    i0.ɵɵelementStart(13, \"div\", 9)(14, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function SingleSauceComponent_div_1_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.onBack());\n    });\n    i0.ɵɵtext(15, \"BACK\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(16, SingleSauceComponent_div_1_button_16_Template, 2, 0, \"button\", 11);\n    i0.ɵɵtemplate(17, SingleSauceComponent_div_1_button_17_Template, 2, 0, \"button\", 12);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const sauce_r2 = ctx.ngIf;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", sauce_r2 == null ? null : sauce_r2.imageUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(sauce_r2 == null ? null : sauce_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"by \", sauce_r2 == null ? null : sauce_r2.manufacturer, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(sauce_r2.description);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.likePending);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.likePending);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.userId === sauce_r2.userId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.userId === sauce_r2.userId);\n  }\n}\n\nexport class SingleSauceComponent {\n  constructor(sauces, route, auth, router) {\n    this.sauces = sauces;\n    this.route = route;\n    this.auth = auth;\n    this.router = router;\n  }\n\n  ngOnInit() {\n    this.userId = this.auth.getUserId();\n    this.loading = true;\n    this.userId = this.auth.getUserId();\n    this.sauce$ = this.route.params.pipe(map(params => params['id']), switchMap(id => this.sauces.getSauceById(id)), tap(sauce => {\n      this.loading = false;\n\n      if (sauce.usersLiked.find(user => user === this.userId)) {\n        this.liked = true;\n      } else if (sauce.usersDisliked.find(user => user === this.userId)) {\n        this.disliked = true;\n      }\n    }));\n  }\n\n  onLike() {\n    if (this.disliked) {\n      return;\n    }\n\n    this.likePending = true;\n    this.sauce$.pipe(take(1), switchMap(sauce => this.sauces.likeSauce(sauce._id, !this.liked).pipe(tap(liked => {\n      this.likePending = false;\n      this.liked = liked;\n    }), map(liked => ({ ...sauce,\n      likes: liked ? sauce.likes + 1 : sauce.likes - 1\n    })), tap(sauce => this.sauce$ = of(sauce))))).subscribe();\n  }\n\n  onDislike() {\n    if (this.liked) {\n      return;\n    }\n\n    this.likePending = true;\n    this.sauce$.pipe(take(1), switchMap(sauce => this.sauces.dislikeSauce(sauce._id, !this.disliked).pipe(tap(disliked => {\n      this.likePending = false;\n      this.disliked = disliked;\n    }), map(disliked => ({ ...sauce,\n      dislikes: disliked ? sauce.dislikes + 1 : sauce.dislikes - 1\n    })), tap(sauce => this.sauce$ = of(sauce))))).subscribe();\n  }\n\n  onBack() {\n    this.router.navigate(['/sauces']);\n  }\n\n  onModify() {\n    this.sauce$.pipe(take(1), tap(sauce => this.router.navigate(['/modify-sauce', sauce._id]))).subscribe();\n  }\n\n  onDelete() {\n    this.loading = true;\n    this.sauce$.pipe(take(1), switchMap(sauce => this.sauces.deleteSauce(sauce._id)), tap(message => {\n      console.log(message);\n      this.loading = false;\n      this.router.navigate(['/sauces']);\n    }), catchError(error => {\n      this.loading = false;\n      this.errorMessage = error.message;\n      console.error(error);\n      return EMPTY;\n    })).subscribe();\n  }\n\n}\n\nSingleSauceComponent.ɵfac = function SingleSauceComponent_Factory(t) {\n  return new (t || SingleSauceComponent)(i0.ɵɵdirectiveInject(i1.SaucesService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i2.Router));\n};\n\nSingleSauceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SingleSauceComponent,\n  selectors: [[\"app-single-sauce\"]],\n  decls: 3,\n  vars: 4,\n  consts: [[4, \"ngIf\"], [\"class\", \"sauce-container\", 4, \"ngIf\"], [1, \"sauce-container\"], [\"alt\", \"\", 3, \"src\"], [1, \"sauce-info\"], [1, \"sauce-name\"], [1, \"manufacturer\"], [\"class\", \"like-buttons\", 4, \"ngIf\"], [\"class\", \"like-pending\", 4, \"ngIf\"], [1, \"control-buttons\"], [\"mat-raised-button\", \"\", 3, \"click\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\", 4, \"ngIf\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", 3, \"click\", 4, \"ngIf\"], [1, \"like-buttons\"], [1, \"likes\"], [1, \"like\", \"fa-thumbs-up\", \"fa-lg\", 3, \"ngClass\", \"click\"], [1, \"dislikes\"], [1, \"dislike\", \"fa-thumbs-down\", \"fa-lg\", 3, \"ngClass\", \"click\"], [1, \"like-pending\"], [1, \"white-spinner\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", 3, \"click\"]],\n  template: function SingleSauceComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, SingleSauceComponent_mat_spinner_0_Template, 1, 0, \"mat-spinner\", 0);\n      i0.ɵɵtemplate(1, SingleSauceComponent_div_1_Template, 18, 8, \"div\", 1);\n      i0.ɵɵpipe(2, \"async\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.loading);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 2, ctx.sauce$));\n    }\n  },\n  dependencies: [i4.NgClass, i4.NgIf, i5.MatSpinner, i6.MatButton, i4.AsyncPipe],\n  styles: [\".sauce-container[_ngcontent-%COMP%] {\\n  display: flex;\\n}\\n.sauce-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  max-height: 70vh;\\n  flex: 1;\\n}\\n.sauce-info[_ngcontent-%COMP%] {\\n  padding: 40px 20px;\\n  flex: 1;\\n}\\n.manufacturer[_ngcontent-%COMP%] {\\n  margin: 0;\\n}\\n.sauce-name[_ngcontent-%COMP%] {\\n  margin: 0;\\n}\\n.like-buttons[_ngcontent-%COMP%] {\\n  display: flex;\\n}\\n.like-buttons[_ngcontent-%COMP%]   i[_ngcontent-%COMP%] {\\n  margin-right: 0.5em;\\n  cursor: pointer;\\n}\\n.likes[_ngcontent-%COMP%], .dislikes[_ngcontent-%COMP%] {\\n  margin: 0 0.4em;\\n}\\n.liked[_ngcontent-%COMP%] {\\n  color: rgb(51, 219, 0);\\n}\\n.disliked[_ngcontent-%COMP%] {\\n  color: rgb(219, 51, 0);\\n}\\n.like[_ngcontent-%COMP%]:hover {\\n  color: rgb(51, 219, 0);\\n}\\n.dislike[_ngcontent-%COMP%] {\\n  transform: scaleX(-1) translateY(5px);\\n}\\n.dislike[_ngcontent-%COMP%]:hover {\\n  color: rgb(219, 51, 0);\\n}\\n.disabled[_ngcontent-%COMP%] {\\n  cursor: none;\\n  color: rgb(190, 190, 190);\\n}\\n.disabled[_ngcontent-%COMP%]:hover {\\n  color: rgb(190, 190, 190);\\n}\\n.control-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  margin: 1em 1em 0 0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNpbmdsZS1zYXVjZS5jb21wb25lbnQuc2NzcyIsIi4uXFwuLlxcLi5cXC4uXFwuLlxcLi5cXC4uXFwuLlxcZm9ybWF0aW9uJTIwY29kYWdlXFxmb3JtYXRpb25PcGVuQ2xhc3Nyb29tc1xcUHJvamV0NlxcUElJUVVBTlRFXFxXZWItRGV2ZWxvcGVyLVA2XFxzcmNcXGFwcFxcc2luZ2xlLXNhdWNlXFxzaW5nbGUtc2F1Y2UuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxhQUFBO0FDQ0Y7QURBRTtFQUNFLGdCQUFBO0VBQ0EsT0FBQTtBQ0VKO0FERUE7RUFDRSxrQkFBQTtFQUNBLE9BQUE7QUNDRjtBREVBO0VBQ0UsU0FBQTtBQ0NGO0FERUE7RUFDRSxTQUFBO0FDQ0Y7QURFQTtFQUNFLGFBQUE7QUNDRjtBREFFO0VBQ0UsbUJBQUE7RUFDQSxlQUFBO0FDRUo7QURFQTtFQUNFLGVBQUE7QUNDRjtBREVBO0VBQ0Usc0JBQUE7QUNDRjtBREVBO0VBQ0Usc0JBQUE7QUNDRjtBREdFO0VBQ0Usc0JBQUE7QUNBSjtBRElBO0VBQ0UscUNBQUE7QUNERjtBREVFO0VBQ0Usc0JBQUE7QUNBSjtBRElBO0VBQ0UsWUFBQTtFQUlBLHlCQUFBO0FDSkY7QURDRTtFQUNFLHlCQUFBO0FDQ0o7QURLRTtFQUNFLG1CQUFBO0FDRkoiLCJmaWxlIjoic2luZ2xlLXNhdWNlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnNhdWNlLWNvbnRhaW5lciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBpbWcge1xyXG4gICAgbWF4LWhlaWdodDogNzB2aDtcclxuICAgIGZsZXg6IDE7XHJcbiAgfVxyXG59XHJcblxyXG4uc2F1Y2UtaW5mbyB7XHJcbiAgcGFkZGluZzogNDBweCAyMHB4O1xyXG4gIGZsZXg6IDE7XHJcbn1cclxuXHJcbi5tYW51ZmFjdHVyZXIge1xyXG4gIG1hcmdpbjogMDtcclxufVxyXG5cclxuLnNhdWNlLW5hbWUge1xyXG4gIG1hcmdpbjogMDtcclxufVxyXG5cclxuLmxpa2UtYnV0dG9ucyB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBpIHtcclxuICAgIG1hcmdpbi1yaWdodDogMC41ZW07XHJcbiAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgfVxyXG59XHJcblxyXG4ubGlrZXMsIC5kaXNsaWtlcyB7XHJcbiAgbWFyZ2luOiAwIDAuNGVtO1xyXG59XHJcblxyXG4ubGlrZWQge1xyXG4gIGNvbG9yOiByZ2JhKDUxLCAyMTksIDAsIDEpO1xyXG59XHJcblxyXG4uZGlzbGlrZWQge1xyXG4gIGNvbG9yOiByZ2JhKDIxOSwgNTEsIDAsIDEpO1xyXG59XHJcblxyXG4ubGlrZSB7XHJcbiAgJjpob3ZlciB7XHJcbiAgICBjb2xvcjogcmdiYSg1MSwgMjE5LCAwLCAxKTtcclxuICB9XHJcbn1cclxuXHJcbi5kaXNsaWtlIHtcclxuICB0cmFuc2Zvcm06IHNjYWxlWCgtMSkgdHJhbnNsYXRlWSg1cHgpO1xyXG4gICY6aG92ZXIge1xyXG4gICAgY29sb3I6IHJnYmEoMjE5LCA1MSwgMCwgMSk7XHJcbiAgfVxyXG59XHJcblxyXG4uZGlzYWJsZWQge1xyXG4gIGN1cnNvcjogbm9uZTtcclxuICAmOmhvdmVyIHtcclxuICAgIGNvbG9yOiByZ2JhKDE5MCwgMTkwLCAxOTAsIDEpO1xyXG4gIH1cclxuICBjb2xvcjogcmdiYSgxOTAsIDE5MCwgMTkwLCAxKTtcclxufVxyXG5cclxuLmNvbnRyb2wtYnV0dG9ucyB7XHJcbiAgYnV0dG9uIHtcclxuICAgIG1hcmdpbjogMWVtIDFlbSAwIDA7XHJcbiAgfVxyXG59XHJcbiIsIi5zYXVjZS1jb250YWluZXIge1xuICBkaXNwbGF5OiBmbGV4O1xufVxuLnNhdWNlLWNvbnRhaW5lciBpbWcge1xuICBtYXgtaGVpZ2h0OiA3MHZoO1xuICBmbGV4OiAxO1xufVxuXG4uc2F1Y2UtaW5mbyB7XG4gIHBhZGRpbmc6IDQwcHggMjBweDtcbiAgZmxleDogMTtcbn1cblxuLm1hbnVmYWN0dXJlciB7XG4gIG1hcmdpbjogMDtcbn1cblxuLnNhdWNlLW5hbWUge1xuICBtYXJnaW46IDA7XG59XG5cbi5saWtlLWJ1dHRvbnMge1xuICBkaXNwbGF5OiBmbGV4O1xufVxuLmxpa2UtYnV0dG9ucyBpIHtcbiAgbWFyZ2luLXJpZ2h0OiAwLjVlbTtcbiAgY3Vyc29yOiBwb2ludGVyO1xufVxuXG4ubGlrZXMsIC5kaXNsaWtlcyB7XG4gIG1hcmdpbjogMCAwLjRlbTtcbn1cblxuLmxpa2VkIHtcbiAgY29sb3I6IHJnYig1MSwgMjE5LCAwKTtcbn1cblxuLmRpc2xpa2VkIHtcbiAgY29sb3I6IHJnYigyMTksIDUxLCAwKTtcbn1cblxuLmxpa2U6aG92ZXIge1xuICBjb2xvcjogcmdiKDUxLCAyMTksIDApO1xufVxuXG4uZGlzbGlrZSB7XG4gIHRyYW5zZm9ybTogc2NhbGVYKC0xKSB0cmFuc2xhdGVZKDVweCk7XG59XG4uZGlzbGlrZTpob3ZlciB7XG4gIGNvbG9yOiByZ2IoMjE5LCA1MSwgMCk7XG59XG5cbi5kaXNhYmxlZCB7XG4gIGN1cnNvcjogbm9uZTtcbiAgY29sb3I6IHJnYigxOTAsIDE5MCwgMTkwKTtcbn1cbi5kaXNhYmxlZDpob3ZlciB7XG4gIGNvbG9yOiByZ2IoMTkwLCAxOTAsIDE5MCk7XG59XG5cbi5jb250cm9sLWJ1dHRvbnMgYnV0dG9uIHtcbiAgbWFyZ2luOiAxZW0gMWVtIDAgMDtcbn0iXX0= */\"]\n});","map":{"version":3,"mappings":"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","names":["catchError","EMPTY","map","of","switchMap","take","tap","i0","SingleSauceComponent","constructor","sauces","route","auth","router","ngOnInit","userId","getUserId","loading","sauce$","params","pipe","id","getSauceById","sauce","usersLiked","find","user","liked","usersDisliked","disliked","onLike","likePending","likeSauce","_id","likes","subscribe","onDislike","dislikeSauce","dislikes","onBack","navigate","onModify","onDelete","deleteSauce","message","console","log","error","errorMessage","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\User\\Desktop\\Hadrien\\formation codage\\formationOpenClassrooms\\Projet6\\PIIQUANTE\\Web-Developer-P6\\src\\app\\single-sauce\\single-sauce.component.ts","C:\\Users\\User\\Desktop\\Hadrien\\formation codage\\formationOpenClassrooms\\Projet6\\PIIQUANTE\\Web-Developer-P6\\src\\app\\single-sauce\\single-sauce.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Sauce } from '../models/Sauce.model';\r\nimport { SaucesService } from '../services/sauces.service';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { AuthService } from '../services/auth.service';\r\nimport { catchError, EMPTY, map, Observable, of, switchMap, take, tap } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-single-sauce',\r\n  templateUrl: './single-sauce.component.html',\r\n  styleUrls: ['./single-sauce.component.scss']\r\n})\r\nexport class SingleSauceComponent implements OnInit {\r\n\r\n  loading!: boolean;\r\n  sauce$!: Observable<Sauce>;\r\n  userId!: string;\r\n  likePending!: boolean;\r\n  liked!: boolean;\r\n  disliked!: boolean;\r\n  errorMessage!: string;\r\n\r\n  constructor(private sauces: SaucesService,\r\n    private route: ActivatedRoute,\r\n    private auth: AuthService,\r\n    private router: Router) { }\r\n\r\n  ngOnInit() {\r\n    this.userId = this.auth.getUserId();\r\n    this.loading = true;\r\n    this.userId = this.auth.getUserId();\r\n    this.sauce$ = this.route.params.pipe(\r\n      map(params => params['id']),\r\n      switchMap(id => this.sauces.getSauceById(id)),\r\n      tap(sauce => {\r\n        this.loading = false;\r\n        if (sauce.usersLiked.find(user => user === this.userId)) {\r\n          this.liked = true;\r\n        } else if (sauce.usersDisliked.find(user => user === this.userId)) {\r\n          this.disliked = true;\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  onLike() {\r\n    if (this.disliked) {\r\n      return;\r\n    }\r\n    this.likePending = true;\r\n    this.sauce$.pipe(\r\n      take(1),\r\n      switchMap((sauce: Sauce) => this.sauces.likeSauce(sauce._id, !this.liked).pipe(\r\n        tap(liked => {\r\n          this.likePending = false;\r\n          this.liked = liked;\r\n        }),\r\n        map(liked => ({ ...sauce, likes: liked ? sauce.likes + 1 : sauce.likes - 1 })),\r\n        tap(sauce => this.sauce$ = of(sauce))\r\n      )),\r\n    ).subscribe();\r\n  }\r\n\r\n  onDislike() {\r\n    if (this.liked) {\r\n      return;\r\n    }\r\n    this.likePending = true;\r\n    this.sauce$.pipe(\r\n      take(1),\r\n      switchMap((sauce: Sauce) => this.sauces.dislikeSauce(sauce._id, !this.disliked).pipe(\r\n        tap(disliked => {\r\n          this.likePending = false;\r\n          this.disliked = disliked;\r\n        }),\r\n        map(disliked => ({ ...sauce, dislikes: disliked ? sauce.dislikes + 1 : sauce.dislikes - 1 })),\r\n        tap(sauce => this.sauce$ = of(sauce))\r\n      )),\r\n    ).subscribe();\r\n  }\r\n\r\n  onBack() {\r\n    this.router.navigate(['/sauces']);\r\n  }\r\n\r\n  onModify() {\r\n    this.sauce$.pipe(\r\n      take(1),\r\n      tap(sauce => this.router.navigate(['/modify-sauce', sauce._id]))\r\n    ).subscribe();\r\n  }\r\n\r\n  onDelete() {\r\n    this.loading = true;\r\n    this.sauce$.pipe(\r\n      take(1),\r\n      switchMap(sauce => this.sauces.deleteSauce(sauce._id)),\r\n      tap(message => {\r\n        console.log(message);\r\n        this.loading = false;\r\n        this.router.navigate(['/sauces']);\r\n      }),\r\n      catchError(error => {\r\n        this.loading = false;\r\n        this.errorMessage = error.message;\r\n        console.error(error);\r\n        return EMPTY;\r\n      })\r\n    ).subscribe();\r\n  }\r\n}\r\n","<mat-spinner *ngIf=\"loading\"></mat-spinner>\r\n<div class=\"sauce-container\" *ngIf=\"sauce$ | async as sauce\">\r\n  <img [src]=\"sauce?.imageUrl\" alt=\"\">\r\n  <div class=\"sauce-info\">\r\n    <h1 class=\"sauce-name\">{{ sauce?.name }}</h1>\r\n    <p class=\"manufacturer\">by {{ sauce?.manufacturer }}</p>\r\n    <h3>Description</h3>\r\n    <p>{{ sauce.description }}</p>\r\n    <div class=\"like-buttons\" *ngIf=\"!likePending\">\r\n      <div class=\"likes\">\r\n        <i [ngClass]=\"{ 'fas liked': liked, 'far': !liked, 'disabled': disliked }\" class=\"like fa-thumbs-up fa-lg\" (click)=\"onLike()\"></i>\r\n        <span>{{ sauce.likes }}</span>\r\n      </div>\r\n      <div class=\"dislikes\">\r\n        <i [ngClass]=\"{ 'fas disliked': disliked, 'far': !disliked, 'disabled': liked }\" class=\"dislike fa-thumbs-down fa-lg\" (click)=\"onDislike()\"></i>\r\n        <span>{{ sauce.dislikes }}</span>\r\n      </div>\r\n    </div>\r\n    <div class=\"like-pending\" *ngIf=\"likePending\">\r\n      <mat-spinner class=\"white-spinner\"></mat-spinner>\r\n    </div>\r\n    <div class=\"control-buttons\">\r\n      <button mat-raised-button (click)=\"onBack()\">BACK</button>\r\n      <button mat-raised-button color=\"primary\" (click)=\"onModify()\" *ngIf=\"userId === sauce.userId\">MODIFY</button>\r\n      <button mat-raised-button color=\"warn\" (click)=\"onDelete()\" *ngIf=\"userId === sauce.userId\">DELETE</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module"}